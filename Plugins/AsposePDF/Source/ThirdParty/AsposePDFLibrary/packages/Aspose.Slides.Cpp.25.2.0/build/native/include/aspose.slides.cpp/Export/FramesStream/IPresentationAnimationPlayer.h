#pragma once
// Copyright (c) 2001-2022 Aspose Pty Ltd. All Rights Reserved.

#include <system/object.h>

#include "aspose_slides_api_defs.h"

/// @cond
namespace Aspose
{
namespace Slides
{
class IImage;
} // namespace Slides
} // namespace Aspose
/// @endcond

namespace Aspose {

namespace Slides {

namespace Export {

/// <summary>
/// Represents a player of the animation.
/// <remarks>
/// Animations generated by <see cref="Aspose::Slides::Export::PresentationAnimationsGenerator">PresentationAnimationsGenerator</see> via its <see cref="PresentationAnimationsGenerator::NewAnimation"></see> event.
/// </remarks> 
/// </summary>
/// <example>
/// <code>
/// void OnNewAnimationGenerated(System::SharedPtr<IPresentationAnimationPlayer> animationPlayer)
/// {
///     System::Console::WriteLine(u"Animation total duration: {0}", animationPlayer->get_Duration());
/// 
///     animationPlayer->SetTimePosition(0);
///     animationPlayer->GetFrame()->Save(u"firstFrame.png");
/// 
///     animationPlayer->SetTimePosition(animationPlayer->get_Duration());
///     animationPlayer->GetFrame()->Save(u"lastFrame.png");
/// }
/// 
/// void RunAnimation()
/// {
///     auto presentation = System::MakeObject<Presentation>(u"animated.pptx");
///     auto animationsGenerator = System::MakeObject<PresentationAnimationsGenerator>(presentation->get_SlideSize()->get_Size().ToSize());
/// 
///     animationsGenerator->NewAnimation += OnNewAnimationGenerated;
///     animationsGenerator->Run(presentation->get_Slides());
/// }
/// </code>
/// </example>    
class ASPOSE_SLIDES_SHARED_CLASS IPresentationAnimationPlayer : public virtual System::Object
{
    typedef IPresentationAnimationPlayer ThisType;
    typedef System::Object BaseType;
    
    typedef ::System::BaseTypesInfo<BaseType> ThisTypeBaseTypesInfo;
    ASPOSE_SLIDES_SHARED_RTTI_INFO_DECL();
    
public:

    /// <summary>
    /// Get animation duration [ms]
    /// </summary>
    virtual ASPOSE_SLIDES_LOCAL_API double get_Duration() = 0;
    
    /// <summary>
    /// Set the animation time position within the <see cref="IPresentationAnimationPlayer::get_Duration"></see>.
    /// </summary>
    /// <param name="time"></param>
    virtual ASPOSE_SLIDES_LOCAL_API void SetTimePosition(double time) = 0;
    /// <summary>
    /// Get the frame for the current time position previously set with the <see cref="IPresentationAnimationPlayer::SetTimePosition"></see> method.
    /// </summary>
    /// <returns></returns>
    virtual ASPOSE_SLIDES_LOCAL_API System::SharedPtr<IImage> GetFrame() = 0;
    
};

} // namespace Export
} // namespace Slides
} // namespace Aspose


